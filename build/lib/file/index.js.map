{"version":3,"file":"index.js","sources":["../../../src/lib/file/base64ToBlob.js","../../../src/lib/file/fileToBase64.js","../../../src/lib/file/downloadByBase64.js","../../../src/lib/file/index.js","../../../src/lib/file/bytesFormat.js","../../../src/lib/file/base64ToFile.js","../../../src/lib/file/blobToBase64.js","../../../src/lib/file/blobToFile.js","../../../src/lib/file/fileToBlob.js","../../../src/lib/file/downloadByImgLink.js","../../../src/lib/file/downloadByImgSelector.js","../../../src/lib/file/bufferFileDownload.js"],"sourcesContent":["/**\r\n * @description: Base64 to Blob\r\n * @param { dataURL } base64 : file base64\r\n * @return { Blob }\r\n */\r\nconst base64ToBlob = function (base64) {\r\n    let mime = base64.split(\",\")[0].split(\":\")[1].split(\";\")[0]; //mime type\r\n    let byte = window.atob(base64.split(\",\")[1]); //base64 decode\r\n    let arrayBuffer = new ArrayBuffer(byte.length); // create buffer array\r\n    let intArray = new Uint8Array(arrayBuffer); // create view\r\n    for (let i = 0, len = byte.length; i < len; i++) {\r\n        intArray[i] = byte.charCodeAt(i);\r\n    }\r\n    return new Blob([intArray], { type: mime });\r\n};\r\n\r\nexport default base64ToBlob;\r\n","/**\r\n * @description: File to Base64\r\n * @param { File } file :  File\r\n * @return { Promise }\r\n */\r\nconst fileToBase64 = function (file) {\r\n    return new Promise(resole => {\r\n        let reader = new FileReader()\r\n        reader.readAsDataURL(file)\r\n        reader.onload = function () {\r\n            resole(this.result)\r\n        }\r\n    })\r\n}\r\nexport default fileToBase64\r\n","/**\r\n * @description: base64数据导出文件下载\r\n * @param {string} filename - 下载时的文件名\r\n * @param {dataURL} base64 - base64字符串\r\n */\r\nconst downloadByBase64 = function (base64, filename = 'default') {\r\n    let a = document.createElement('a')\r\n    a.style = 'display: none'\r\n    document.body.appendChild(a)\r\n    a.download = filename\r\n    a.href = base64\r\n    if (document.createEvent) {\r\n        let downloadEvt = document.createEvent('MouseEvents')\r\n        downloadEvt.initEvent('click', true, false)\r\n        a.dispatchEvent(downloadEvt)\r\n    } else if (document.createEventObject) {\r\n        a.fireEvent('onclick')\r\n    } else if (typeof a.onclick == 'function') {\r\n        a.onclick()\r\n    }\r\n    document.body.removeChild(a)\r\n}\r\nexport default downloadByBase64\r\n","import bytesFormat from './bytesFormat'\r\nimport base64ToBlob from './base64ToBlob'\r\nimport base64ToFile from './base64ToFile'\r\nimport blobToBase64 from './blobToBase64'\r\nimport blobToFile from './blobToFile'\r\nimport fileToBase64 from './fileToBase64'\r\nimport fileToBlob from './fileToBlob'\r\nimport downloadByBase64 from './downloadByBase64'\r\nimport downloadByImgLink from './downloadByImgLink'\r\nimport downloadByImgSelector from './downloadByImgSelector'\r\nimport bufferFileDownload from './bufferFileDownload'\r\n\r\nexport default {\r\n    bytesFormat,\r\n    base64ToBlob,\r\n    base64ToFile,\r\n    blobToBase64,\r\n    blobToFile,\r\n    fileToBase64,\r\n    fileToBlob,\r\n    downloadByBase64,\r\n    downloadByImgLink,\r\n    downloadByImgSelector,\r\n    bufferFileDownload\r\n}\r\n","/**\r\n * @description: (bytes)字节数自动转换\r\n * @param {Number} bytes: 字节数\r\n */\r\nconst bytesFormat = function (bytes) {\r\n    if (bytes === 0) return '0 B'\r\n    if (!bytes) return ''\r\n    let k = 1024\r\n    let sizes = ['B', 'KB', 'MB', 'GB', 'TB', 'PB', 'EB', 'ZB', 'YB']\r\n    let i = Math.floor(Math.log(bytes) / Math.log(k))\r\n    let num = bytes / Math.pow(k, i)\r\n    return num.toFixed(2) + ' ' + sizes[i]\r\n}\r\nexport default bytesFormat\r\n","/**\r\n * @description: Base64 to File\r\n * @param dataURL   {String}  base64\r\n * @param fileName   {String}  file name\r\n * @returns {File}\r\n */\r\nconst base64ToFile = function (base64, fileName) {\r\n    let arr = base64.split(','),\r\n        mimeType = arr[0].match(/:(.*?);/)[1], //base64文件类型\r\n        bStr = atob(arr[1]),\r\n        n = bStr.length,\r\n        u8arr = new Uint8Array(n)\r\n    while (n--) {\r\n        u8arr[n] = bStr.charCodeAt(n)\r\n    }\r\n    return new File([u8arr], fileName, { type: mimeType })\r\n}\r\nexport default base64ToFile\r\n","/**\r\n * @description: Blob to Base64\r\n * @param  {Blob} blob\r\n * @return {Promise<dataURL>} Base64\r\n */\r\nconst blobToBase64 = function (blob) {\r\n    return new Promise(resolve => {\r\n        let reader = new FileReader()\r\n        reader.onload = function (e) {\r\n            resolve(e.target.result)\r\n        }\r\n        reader.readAsDataURL(blob)\r\n    })\r\n}\r\nexport default blobToBase64\r\n","/**\r\n * @description: Blob  to  File\r\n * @param  { Blob } blob\r\n * @param { String } filename : file name\r\n * @return { File } File\r\n */\r\nconst blobToFile = function (blob, filename) {\r\n    return new File([blob], filename, { type: blob.type, lastModified: Date.now() })\r\n}\r\nexport default blobToFile\r\n","import fileToBase64 from \"./fileToBase64\";\r\nimport base64ToBlob from \"./base64ToBlob\";\r\n\r\n/**\r\n * @description: File to Blob\r\n * @param  { File } file: File object\r\n * @return { Promise }\r\n */\r\nconst fileToBlob = function (file) {\r\n    return fileToBase64(file).then((r) => base64ToBlob(r));\r\n};\r\nexport default fileToBlob;\r\n","import downloadByBase64 from \"./downloadByBase64\"\r\n/**\r\n * 根据 url下载图片\r\n * @param {string} url - 图片url地址\r\n * @param {string} fileName - 图片名称\r\n * @param {Number} w - 图片宽\r\n * @param {Number} h - 图片高\r\n */\r\nconst downloadByImgLink = function (url,fileName, w, h) {\r\n    return new Promise((resolve,reject) => {\r\n        let img = new Image()\r\n        img.src = url\r\n        img.crossOrigin = 'anonymous'\r\n        // img.setAttribute('crossOrigin', 'anonymous')\r\n        img.onload = function () {\r\n            //默认按比例压缩\r\n            ;(w = w || this.width), (h = h || this.height)\r\n            let quality = 0.95 // 默认图片质量为0.95\r\n            //生成canvas\r\n            let canvas = document.createElement('canvas')\r\n            let ctx = canvas.getContext('2d')\r\n            // 创建属性节点\r\n            canvas.setAttribute('width', w)\r\n            canvas.setAttribute('height', h)\r\n            ctx.drawImage(this, 0, 0, w, h)\r\n            // quality值越小，所绘制出的图像越模糊\r\n            let base64 = canvas.toDataURL('image/png', quality)\r\n            // 回调函数返回base64的值\r\n            downloadByBase64(base64,fileName)\r\n            resolve(base64)\r\n        }\r\n        img.onerror = e=>reject(e)\r\n    })\r\n}\r\nexport default downloadByImgLink\r\n","/**\r\n * Download Image to local:\r\n * the main principle is to use the download attribute of a tag and todataurl () of canvas\r\n * @param { String | Element } selector: Selector of img tag or img element\r\n * @param { String } name：Download Image Name\r\n */\r\nconst downloadByImgSelector = function (selector, name) {\r\n    return new Promise((resolve,reject)=>{\r\n        let image = new Image()\r\n        // Solving cross domain canvas pollution problem\r\n        image.setAttribute('crossOrigin', 'anonymous')\r\n        image.onload = function () {\r\n            // 创建一个canvas标签\r\n            let canvas = document.createElement('canvas')\r\n            // 设置canvas的宽高\r\n            canvas.width = image.width\r\n            canvas.height = image.height\r\n            // 获取canvas的2d界面\r\n            let context = canvas.getContext('2d')\r\n            // 把图片画在canvas上\r\n            context.drawImage(image, 0, 0, canvas.width, canvas.height)\r\n            // 把canvas的内容转化为base64格式\r\n            let url = canvas.toDataURL('image/png')\r\n            // 生成一个a元素\r\n            let a = document.createElement('a')\r\n            // 创建一个单击事件\r\n            let event = new MouseEvent('click')\r\n            // 将a的download属性设置为我们想要下载的图片名称，若name不存在则使用‘下载图片名称’作为默认名称\r\n            a.download = name || 'defaultName'\r\n            // 将生成的URL设置为a.href属性\r\n            a.href = url\r\n            // 触发a的单击事件\r\n            a.dispatchEvent(event)\r\n            resolve()\r\n        }\r\n        image.onerror = e=>reject(e)\r\n        // 获取img上的src值，赋值之后，完成之后会调用onload事件\r\n        image.src = typeof selector === 'string' ? document.querySelector(selector).src : selector.src\r\n    })\r\n}\r\nexport default downloadByImgSelector\r\n","/**\r\n * Buffer下载文件\r\n * @param {Buffer} buffer\r\n * @param {String} fileName\r\n */\r\nconst bufferFileDownload = (buffer, fileName) => {\r\n  /* eslint-disable */\r\n  var blob = new Blob([buffer], { type: 'charset=utf-8' })\r\n  var a = document.createElement('a')\r\n  var url = window.URL.createObjectURL(blob)\r\n  a.href = url\r\n  a.download = fileName\r\n  var body = document.getElementsByTagName('body')[0]\r\n  body.appendChild(a)\r\n  a.click()\r\n  body.removeChild(a)\r\n  window.URL.revokeObjectURL(url)\r\n}\r\n\r\nexport default bufferFileDownload\r\n"],"names":["base64ToBlob","base64","mime","split","byte","window","atob","arrayBuffer","ArrayBuffer","length","intArray","Uint8Array","i","len","charCodeAt","Blob","type","fileToBase64","file","Promise","resole","reader","FileReader","readAsDataURL","onload","this","result","downloadByBase64","filename","a","document","createElement","style","body","appendChild","download","href","createEvent","downloadEvt","initEvent","dispatchEvent","createEventObject","fireEvent","onclick","removeChild","bytesFormat","bytes","Math","floor","log","pow","toFixed","base64ToFile","fileName","arr","mimeType","match","bStr","n","u8arr","File","blobToBase64","blob","resolve","e","target","blobToFile","lastModified","Date","now","fileToBlob","then","downloadByImgLink","url","w","h","reject","img","Image","src","crossOrigin","width","height","canvas","ctx","getContext","setAttribute","drawImage","toDataURL","onerror","downloadByImgSelector","selector","name","image","event","MouseEvent","querySelector","bufferFileDownload","buffer","URL","createObjectURL","getElementsByTagName","click","revokeObjectURL"],"mappings":"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"}